<app-topmenu>
  <div buttons>
    <button mat-flat-button type="button" color="primary" (click)="save()" [disabled]="!(form?.dirty)">Save</button>
  </div>
</app-topmenu>
<div class="loading-shade" *ngIf="saving">
  <mat-progress-spinner mode="indeterminate" diameter="50"></mat-progress-spinner>
</div>
<div *ngIf="form">
  <form [formGroup]="form">
    <section class="settings-section">
      <mat-form-field appearance="fill">
        <mat-label>WorldCat API Key: </mat-label> 
        <input matInput formControlName="wckey">
      </mat-form-field>
    </section>
    <section class="settings-section">
      <mat-checkbox formControlName="doPresearch">Perform pre-search on the following fields:</mat-checkbox>
    </section>   
    <section class="settings-section">
      <mat-form-field appearance="fill">
        <mat-chip-list #preSearchTags>
          <mat-chip 
            *ngFor="let field of form.get('preSearchList').value"
            (removed)="deletePreSearchField(field)" >
            {{field}}
            <mat-icon matChipRemove>cancel</mat-icon>
          </mat-chip>
          <input matChipInput placeholder="Add Tag (e.g. 245, 7xx)"
           [matChipInputFor]="preSearchTags"
           [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
           [matChipInputAddOnBlur]="addOnBlur"
           (matChipInputTokenEnd)="addPreSearchField($event)">
        </mat-chip-list>
      </mat-form-field>
    </section> 
    <section class="settings-section">
      <mat-checkbox formControlName="doSwap">After adding a parallel field, swap original field and 880 (if needed) so that:</mat-checkbox>
    </section>
    <section class="settings-section">
      <mat-radio-group formControlName="swapType">
        &nbsp;&nbsp;<mat-radio-button value="roman">Roman text is in field 880</mat-radio-button>&nbsp;&nbsp;
        &nbsp;&nbsp;<mat-radio-button value="nonroman">Non-roman text is in field 880</mat-radio-button>
      </mat-radio-group>
    </section>
    <section class="settings-section">
      <mat-checkbox formControlName="pinyinonly">Chinese: Don't search WorldCat, only convert characters to Pinyin</mat-checkbox>    
    </section>
    <section class="settings-section">
      <mat-checkbox formControlName="searchWG">Chinese: Search for Pinyin equivalents of Wade-Giles text</mat-checkbox> 
    </section>
    <div *ngIf="admin|async">
    <section class="settings-section">
      <mat-checkbox formControlName="adminWC">Set WC Key for all users (Admin only)</mat-checkbox>  
    </section>
    </div>
  </form>
</div>